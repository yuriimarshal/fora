<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>FORA</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--<link rel="stylesheet" href="css/main.css">-->
    <style>
        fieldset,hr{border:0;padding:0}#script,header{width:100%;text-align:center}.checkbox-container input[type=checkbox],.invisible{visibility:hidden}html{color:#222;font-size:1em;line-height:1.3}::-moz-selection{background:#b3d4fc;text-shadow:none}::selection{background:#b3d4fc;text-shadow:none}hr{display:block;height:1px;border-top:1px solid #ccc;margin:1em 0}audio,canvas,iframe,img,svg,video{vertical-align:middle}fieldset{margin:0}textarea{resize:vertical}.browserupgrade{margin:.2em 0;background:#ccc;color:#000;padding:.2em 0}:focus{outline:0!important}html *{font-family:Roboto;color:#36404d;letter-spacing:.01em}body{background-color:#f1f3f6}.logo{margin:4px 0}#script .index{width:40%}#script .submit{width:50%;font-weight:700}#script .question{margin:6px auto 20px;font-size:21px}#script .index-container{background-color:#fff;margin:0 auto;padding:40px 15px;display:inline-block;border-radius:4px;box-shadow:0 6px 6px -3px rgba(90,90,90,.1),0 10px 14px 1px rgba(90,90,90,.14),0 4px 18px 3px rgba(90,90,90,.12)}#script .index-container input{width:51px;height:60px;font-size:25px;margin:0 12px;border-radius:4px}#range-btn-0{background-color:#e7342a}#range-btn-1{background-color:#f46d47}#range-btn-2{background-color:#f27c32}#range-btn-3{background-color:#f18329}#range-btn-4{background-color:#f08920}#range-btn-5{background-color:#e59613}#range-btn-6{background-color:#aea81d}#range-btn-7{background-color:#a0ac20}#range-btn-8{background-color:#7ab826}#range-btn-9{background-color:#79b927}.node-title{padding:20px 0;font-weight:700;font-size:20px;text-align:left}.dictionary-title{text-align:left;padding:0 25px 10px;font-size:14px}.toggle-container{width:100%;text-align:left;background-color:#f1f3f6;border-radius:5px;margin-bottom:10px}.toggle-container .toggle-title{padding:15px 20px 10px;font-size:20px}.toggle-container .toggle-title:hover{cursor:pointer;box-shadow:inset 0 0 100px 100px rgba(255,255,255,.2)}.toggle-container .toggle-body{display:none;padding:10px;border-top:2px solid #e1e3e6}.submit-sheet{margin:0 auto;padding:0 20px;border-radius:5px;background-color:#fff;box-shadow:0 6px 6px -3px rgba(90,90,90,.1),0 10px 14px 1px rgba(90,90,90,.14),0 4px 18px 3px rgba(90,90,90,.12);width:55.5%}#submit-btn{margin:40px 0;background-color:#6db218;width:200px;height:50px;font-size:20px;border-top-left-radius:10px;border-bottom-right-radius:10px}.btn{color:#fff;font-weight:700;border:none;transition:all .3s ease}.btn:hover{cursor:pointer;box-shadow:inset 0 0 100px 100px rgba(255,255,255,.2)}.btn:active{box-shadow:inset 0 0 10px rgba(0,0,0,.5)}.checkbox-container{position:relative;margin-bottom:9px}.checkbox-container span{position:absolute;top:-1px;left:25px}.checkbox-container label{position:absolute;width:14px;height:14px;top:0;left:0;cursor:pointer;background:#79b927;border:1px solid #659a20;border-radius:5px}.checkbox-container label:hover{box-shadow:inset 0 0 100px 100px rgba(255,255,255,.2)}.checkbox-container label:after{opacity:0;content:'';position:absolute;width:8px;height:3px;background:0 0;top:3px;left:2px;border:2px solid #fff;border-top:none;border-right:none;transform:rotate(-45deg)}.checkbox-container input[type=checkbox]:checked+label:after{opacity:1}.input-container{display:flex;flex-direction:column;text-align:left;margin-left:25px;font-size:14px}.input-container label{margin-bottom:9px}.input-container textarea{min-height:38px;width:50%}.input-container textarea::placeholder{color:#c4c7ca}.t-area{resize:none;border-radius:5px;border:1px solid #caccce;padding:10px 9px}.textarea-container{display:flex;flex-direction:column;text-align:left}.textarea-container textarea{background-color:#fafbfc;min-height:58px;font-size:17px}.textarea-container textarea::placeholder{font-size:17px;color:#c4c7ca}.hidden{display:none!important}.visuallyhidden{border:0;-webkit-clip-path:inset(50%);clip-path:inset(50%);display:inline-block;height:1px;margin:-1px;overflow:hidden;padding:0;width:1px;white-space:nowrap}.visuallyhidden.focusable:active,.visuallyhidden.focusable:focus{clip:auto;-webkit-clip-path:none;clip-path:none;height:auto;margin:0;overflow:visible;position:static;width:auto;white-space:inherit}.clearfix:after,.clearfix:before{content:" ";display:table}.clearfix:after{clear:both}@media print{blockquote,img,pre,tr{page-break-inside:avoid}*,:after,:before{background:0 0!important;color:#000!important;box-shadow:none!important;text-shadow:none!important}a,a:visited{text-decoration:underline}a[href]:after{content:" (" attr(href) ")"}abbr[title]:after{content:" (" attr(title) ")"}a[href^="#"]:after,a[href^="javascript:"]:after{content:""}pre{white-space:pre-wrap!important}blockquote,pre{border:1px solid #999}thead{display:table-header-group}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}}
    </style>
</head>
<body>
<header>
    <img class="logo" src="logo.png" alt="logo">
</header>
<script src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
</script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-3.2.1.min.js"><\/script>')</script>
<script src="js/data/json.js"></script>
<!--<script src="js/main.js"></script>-->
<script>
    $(function(){"use strict";function e(e){x.empty(),e.forEach(function(e){e.if&&s(e.if[0])&&(p=e.questions[0].group,v=e.questions[0].questions)}),e.forEach(function(e){e.group&&(g=e)}),x.append($("<div class='submit question'>"+p+"</div>"),$("<div class='submit-sheet'></div>")),x=$(".submit-sheet"),t(v),n(g),x.append($("<button id='submit-btn' class='btn'>Готово</button>")),$("#submit-btn").on("click",c)}function t(e){e.forEach(function(e){if(e.questions){switch(e.type){case"h2":(x=$(".submit-sheet")).append($("<div class='node-title'></div>").text(e.group));break;case"toggle":f++,(x=$(".submit-sheet")).append($("<div class='toggle-container'><div id='toggle-"+f+"' class='toggle-title'>"+e.group+"</div><div class='toggle-body toggle-"+f+"'></div></div>")),x=$(".toggle-"+f),a(f);break;case"dictionary":x.append($("<div class='dictionary-title'></div>").text(e.group))}t(e.questions)}else i(e)})}function i(e){var i,n;if("dictionary"===e.answer.type)m.forEach(function(i){i.id===e.answer.id&&(i.type="dictionary",i.group=e.question,t([i]))});else{switch(e.answer.type){case"checkbox":x.append($("<div class='checkbox-container'><input type='checkbox' id='"+e.id+"'/><label for='"+e.id+"'></label><span>"+e.question+"</span></div>"));break;case"input":x.append($("<div class='input-container'><textarea class='t-area' placeholder='"+e.question+"'id='"+e.id+"'></textarea>"));break;case"textarea":x.append($("<div class='textarea-container'><textarea class='t-area' placeholder='"+e.answer.title+"'id='"+e.id+"'></textarea>"))}(i=$("#"+e.id)).on("change",function(){switch(e.answer.type){case"checkbox":n=i.is(":checked");break;default:n=i.val()}o(e.id,n)})}}function n(e){e.questions&&(e.group&&(x=$(".submit-sheet")).append($("<div class='node-title'></div>").text(e.group)),i(e.questions[0]))}function s(e){for(var t in e)switch(t){case"lt":return d<e[t];case"lte":return d<=e[t];case"e":return d=e[t];case"gte":return d>=e[t];case"gt":return d>e[t]}}function a(e){$("#toggle-"+e).on("click",function(){$(".toggle-"+e).toggle(200)})}function o(e,t){for(var i=0;i<l.length;i+=1)if(l[i].question_id===e)return void(t?l[i].answer=t:l.splice(i,1));l.push({question_id:e,answer:t})}function c(){b=$("#comment-block").val()||!1,y={form_id:u,spdIndex:d,answers:l,userInfo:k,commentBlock:b},console.log(y),$.ajax({type:"POST",url:"http://some/url",data:JSON.stringify(y),dataType:"json",success:function(e){console.log(e)}})}var r=JSON.parse(json)||{},d=null,u=null,l=[],p="",f=0,v={},g={},b="",h=[],x=null,m=[],y=[],q=function(e){var t,i,n=decodeURIComponent(window.location.search.substring(1)).split("&");for(i=0;i<n.length;i++)if((t=n[i].split("="))[0]===e)return void 0===t[1]||t[1]},k={filial:q("filial")||!1,card:q("card")||!1};!function(t){for(var i in r)"form"===i&&(h=r[i]),"dictionary"===i&&(m=r[i]);for(var n in h)if("id"===n&&(u=h[n]),"questions"===n){var s=0,a=h[n][0].answer.values;for($("body").append($("<div id='script'></div>")),(x=$("#script")).append($("<div class='index question'></div>").text(h[n][0].question),$("<div class='index-container'></div>"));s<a.length;)$(".index-container").append($("<input class='btn' id='range-btn-"+s+"' type='button' value='"+a[s]+"'/>")),$("#range-btn-"+s).on("click",function(){d=this.value,o(h[n][0].id,d),e(h[n][0].submit)}),s++}}(json)});
</script>
</body>
</html>
