<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>FORA</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans" />

    <!--<link rel="stylesheet" href="css/main.css">-->
    <style>
        #script .submit,.btn,.node-title,header .container .info span{font-weight:700}:focus{outline:0!important}html *{font-family:"Open Sans";color:#36404d}body{margin:0;background-color:#f1f3f6;text-align:center}header{width:100%;background-color:#fff}header .container{width:57%;height:80px;margin:0 auto;display:flex;flex-direction:row;justify-content:space-between;align-items:center}header .container .info{text-align:right;line-height:1.5em}#script{width:100%;text-align:center}#script .index{width:40%}#script .submit{width:50%}#script .question{margin:21px auto 20px;font-size:20px;font-weight:700}#script .index-container{background-color:#fff;margin:0 auto;padding:40px 10px;display:inline-block;border-radius:4px;box-shadow:0 6px 6px -3px rgba(90,90,90,.1),0 10px 14px 1px rgba(90,90,90,.14),0 4px 18px 3px rgba(90,90,90,.12)}#script .index-container input{width:51px;height:60px;font-size:25px;margin:0 9px;border-radius:4px}#range-btn-0{background-color:#e12117}#range-btn-1{background-color:#e7342a}#range-btn-2{background-color:#f46d47}#range-btn-3{background-color:#f27c32}#range-btn-4{background-color:#f18329}#range-btn-5{background-color:#f08920}#range-btn-6{background-color:#e59613}#range-btn-7{background-color:#aea81d}#range-btn-8{background-color:#a0ac20}#range-btn-9{background-color:#7ab826}#range-btn-10{background-color:#79b927}.node-title{padding:20px 0;font-size:20px;text-align:left}.dictionary-title{text-align:left;padding:0 25px 10px;font-size:14px}.toggle-container{width:100%;text-align:left;background-color:#f1f3f6;border-radius:5px;margin-bottom:10px}.toggle-container .toggle-title{padding:14px 35px 10px;font-size:20px}.toggle-container .toggle-title:hover{cursor:pointer;box-shadow:inset 0 0 100px 100px rgba(255,255,255,.2)}.toggle-container .toggle-body{display:none;padding:10px;border-top:2px solid #e1e3e6}.toggle-container .checkbox-container .toggle-checkbox{top:19px;left:10px;position:absolute;z-index:0}.submit-sheet{margin:0 auto 30px;padding:0 20px;border-radius:5px;background-color:#fff;box-shadow:0 6px 6px -3px rgba(90,90,90,.1),0 10px 14px 1px rgba(90,90,90,.14),0 4px 18px 3px rgba(90,90,90,.12);width:54%}#submit-btn{margin:40px 0;background-color:#6db218;width:200px;height:50px;font-size:20px;border-top-left-radius:10px;border-bottom-right-radius:10px}.btn{color:#fff;border:none;transition:all .3s ease}.btn:hover{cursor:pointer;box-shadow:inset 0 0 100px 100px rgba(255,255,255,.2)}.btn:active{box-shadow:inset 0 0 10px rgba(0,0,0,.5)}.checkbox-container{position:relative}.checkbox-container.bottom{margin-bottom:7px}.checkbox-container.bottom label{margin-top:8px}.checkbox-container input[type=checkbox]{visibility:hidden}.checkbox-container input[type=text]{min-width:42%;margin-left:20px;font-size:12px;padding:8px 10px;border-radius:3px;border:1px solid #caccce}.checkbox-container span{margin-left:6px}.checkbox-container label{position:absolute;width:14px;height:14px;top:0;left:0;cursor:pointer;background:#79b927;border:1px solid #659a20;border-radius:5px}.checkbox-container label:hover{box-shadow:inset 0 0 100px 100px rgba(255,255,255,.2)}.checkbox-container label:after{opacity:0;content:'';position:absolute;width:8px;height:3px;background:0 0;top:3px;left:2px;border:2px solid #fff;border-top:none;border-right:none;transform:rotate(-45deg)}.checkbox-container input[type=checkbox]:checked+label:after{opacity:1}.input-container{display:flex;flex-direction:column;text-align:left;margin-left:25px;font-size:14px}.input-container label{margin-bottom:9px}.input-container textarea{min-height:38px;width:50%}.input-container textarea::placeholder{color:#c4c7ca}.t-area{resize:none;border-radius:5px;border:1px solid #caccce;padding:10px 9px}.textarea-container{display:flex;flex-direction:column;text-align:left}.textarea-container textarea{background-color:#fafbfc;min-height:58px;font-size:17px}.textarea-container textarea::placeholder{font-size:17px;color:#c4c7ca}
    </style>
</head>
<body>
<header>
    <div class="container">
        <img class="logo" src="logo.png" alt="logo">
        <!--for example, URL:-->
        <!--http://fora.com/?filial=вул.+Богдана+Хмельницького%2C+18&card=0201234567890-->
        <div class="info">
            <div class="card">Номер картки лояльності: <span id="user-card"></span></div>
            <div class="address">Адреса магазину: <span id="user-filial"></span></div>
        </div>
    </div>
</header>
<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous">
</script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-3.2.1.min.js"><\/script>')</script>
<!--<script src="js/data/json.js"></script>-->
<!--<script src="js/main.js"></script>-->
<script>
    var json={form:{id:"wecrm0wiecom",questions:[{id:"awp93c30p",question:"Наскільки ймовірно, що Ви порадите робити покупки в мережі магазинів Фора своїм друзям та колегам?",answer:{type:"range",values:[0,1,2,3,4,5,6,7,8,9,10]},submit:[{if:[{lte:8}],questions:[{group:"Будь ласка, підкажіть, що саме засмутило Вас найбільше?",type:"h1",questions:[{group:"Товар, асортимент",type:"h2",questions:[{group:"Товару, що мене цікавив, не було у наявності",type:"toggle",id:"ntgrgrt3jvf",questions:[{id:"204c24203",question:"Уточніть, будь ласка, товару з якої категорії не було у наявності:",answer:{type:"dictionary",id:"nvfj4343jvf"}}]},{group:"Не було у наявності сезонних фруктів та/або овочів",type:"toggle",id:"nt455grt3jvf",questions:[{id:"erhf345hjb44",question:"Уточніть, будь ласка, чого саме",answer:{type:"input"}}]},{group:"Мене не влаштувала свіжість та якість деяких товарів",type:"toggle",id:"ntgr785t3jvf",questions:[{id:"erhf3fergb44",question:"Уточніть, будь ласка, яких саме",answer:{type:"input"}}]}]},{group:"Ціни",type:"h2",questions:[{group:"Ціни на потрібні мені товари були вищими ніж в інших торгових точках",type:"toggle",id:"234rgrt3jvf",questions:[{id:"erhf454rgb44",question:"Уточніть, будь ласка, яких саме товарів",answer:{type:"input"}}]},{group:"Ціни на сезонні фрукти та/або овочі зависокі",type:"toggle",id:"n5345363jvf",questions:[{id:"erh43fdgegb44",question:"Уточніть, будь ласка, на які саме",answer:{type:"input"}}]}]}]}]},{if:[{gt:8}],questions:[{group:"Підкажіть, будь ласка, що Вам сподобалось найбільше?",type:"h1",questions:[{}]}]},{group:"Можливо Ви маєте ще коментар, яким бажаєте поділитися? Залиште його тут, він обов'язково буде прочитаний",type:"h2",questions:[{id:"qc3023c2pd",answer:{type:"textarea",title:"Напишіть ваш коментар"}}]}]}]},dictionary:[{id:"nvfj4343jvf",questions:[{id:"qwerty1",question:"АЛКОГОЛЬНІ НАПОЇ",answer:{type:"checkbox"}},{id:"qwerty2",question:"БАКАЛІЯ(крупи, макаронні вироби)",answer:{type:"checkbox"}},{id:"qwerty3",question:"ДИТЯЧЕ ХАРЧУВАННЯ",answer:{type:"checkbox"}},{id:"qwerty4",question:"КОВБАСНІ ВИРОБИ",answer:{type:"checkbox"}}]}]};json=JSON.stringify(json);
</script>
<script>
    $(function(){"use strict";function e(e){x.empty(),e.forEach(function(e){e.if&&s(e.if[0])&&(p=e.questions[0].group,v=e.questions[0].questions)}),e.forEach(function(e){e.group&&(g=e)}),x.append($("<div class='submit question'>"+p+"</div>"),$("<div class='submit-sheet'></div>")),x=$(".submit-sheet"),i(v),n(g),x.append($("<button id='submit-btn' class='btn'>Готово</button>")),$("#submit-btn").on("click",c)}function i(e){e.forEach(function(e){if(e.questions){switch(e.type){case"h2":(x=$(".submit-sheet")).append($("<div class='node-title'></div>").text(e.group));break;case"toggle":f++,(x=$(".submit-sheet")).append($("<div class='toggle-container'><div class='checkbox-container' id='toggle-"+e.id+"'><input class='toggle-checkbox' type='checkbox' id='tc-"+e.id+"'/><label class='toggle-checkbox' for='tc-"+e.id+"'></label><div class='toggle-title'>"+e.group+"</div></div><div class='toggle-body toggle-"+e.id+"'></div></div>")),x=$(".toggle-"+e.id),a(e.id);break;case"dictionary":x.append($("<div class='dictionary-title'></div>").text(e.group))}i(e.questions)}else t(e)})}function t(e){var t,n,s;if(e.answer)if("dictionary"===e.answer.type)y.forEach(function(t){t.id===e.answer.id&&(t.type="dictionary",t.group=e.question,i([t]))});else{switch(e.answer.type){case"checkbox":x.append($("<div class='checkbox-container bottom'><input type='checkbox' id='"+e.id+"'/><label for='"+e.id+"'></label><span>"+e.question+"</span><input id='dt-"+e.id+"' style='visibility: hidden' type='text' placeholder='Назва продукції' /></div>"));break;case"input":x.append($("<div class='input-container'><textarea class='t-area' placeholder='"+e.question+"'id='"+e.id+"'></textarea>"));break;case"textarea":x.append($("<div class='textarea-container'><textarea class='t-area' placeholder='"+e.answer.title+"'id='"+e.id+"'></textarea>"))}(t=$("#"+e.id)).on("change",function(){switch(e.answer.type){case"checkbox":(n=t.is(":checked"))?$("#dt-"+e.id).css("visibility","visible"):$("#dt-"+e.id).css("visibility","hidden"),s=$("#dt-"+e.id).val(""),$("#dt-"+e.id).on("change",function(){o(e.id,s[0].value)});break;default:s=t.val()}o(e.id,s)})}}function n(e){e.questions&&(e.group&&(x=$(".submit-sheet")).append($("<div class='node-title'></div>").text(e.group)),t(e.questions[0]))}function s(e){for(var i in e)switch(i){case"lt":return r<e[i];case"lte":return r<=e[i];case"e":return r=e[i];case"gte":return r>=e[i];case"gt":return r>e[i]}}function a(e){$("#toggle-"+e).on("click",function(i){o(e,!0),$(".toggle-"+e).toggle(200),$("#tc-"+e).prop("checked",!$("#tc-"+e).is(":checked")),i.preventDefault()})}function o(e,i){for(var t=0;t<u.length;t+=1)if(u[t].question_id===e)return void(!1===i?u.splice(t,1):u[t].answer=i);u.push({question_id:e,answer:i})}function c(){b=$("#comment-block").val()||!1,k={form_id:l,spdIndex:r,answers:u,userInfo:q,commentBlock:b},console.log(k),$.ajax({type:"POST",url:"http://fora.development.digicode.ua/api/questionnaire",data:JSON.stringify(k),dataType:"json",success:function(e){console.log(e)}})}var d=JSON.parse(json)||{},r=null,l=null,u=[],p="",f=0,v={},g={},b="",h=[],x=null,y=[],k=[],m=function(e){var i,t,n=decodeURIComponent(window.location.search.substring(1)).split("&");for(t=0;t<n.length;t++)if((i=n[t].split("="))[0]===e)return i[1]=i[1].replace(/\+/g," "),void 0===i[1]||i[1]},q={filial:m("filial"),card:m("card")};$("#user-filial").text(q.filial),$("#user-card").text(q.card),function(){for(var i in d)"form"===i&&(h=d[i]),"dictionary"===i&&(y=d[i]);for(var t in h)if("id"===t&&(l=h[t]),"questions"===t){var n=0,s=h[t][0].answer.values;for($("body").append($("<div id='script'></div>")),(x=$("#script")).append($("<div class='index question'></div>").text(h[t][0].question),$("<div class='index-container'></div>"));n<s.length;)$(".index-container").append($("<input class='btn' id='range-btn-"+n+"' type='button' value='"+s[n]+"'/>")),$("#range-btn-"+n).on("click",function(){r=this.value,o(h[t][0].id,r),e(h[t][0].submit)}),n++}}(json)});
</script>
</body>
</html>
